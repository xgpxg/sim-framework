(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11a7ce03"],{"41fd":function(t,e,a){(function(e){(function(e,a){t.exports=a()})("object"==typeof window&&window,function(){"use strict";var t={};return t=console.log.bind(console),t=t||function(){},t.info=function(){console.info.apply(console,arguments)},t.error=function(){console.error.apply(console,arguments)},t})}).call(this,a("c8ba"))},4382:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"search-list-vue frame-page h-panel"},[a("div",{staticClass:"h-panel-bar"},[a("div",{staticClass:"search-picker"},[a("SearchFilter",{attrs:{datas:t.dicts.group,prop:"group",title:"分组"},model:{value:t.params,callback:function(e){t.params=e},expression:"params"}}),a("SearchFilter",{attrs:{datas:t.dicts.status,prop:"state",title:"任务状态"},model:{value:t.params,callback:function(e){t.params=e},expression:"params"}})],1)]),a("Table",{attrs:{datas:t.initData,height:600,loading:t.loading}},[a("TableItem",{attrs:{title:"ID",prop:"id",align:"center",width:50}}),a("TableItem",{attrs:{title:"任务名称",width:100,prop:"taskName",align:"center"}}),a("TableItem",{attrs:{title:"分组",prop:"group",align:"center",width:80}}),a("TableItem",{attrs:{title:"任务类",align:"center",width:200},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.data;return[a("span",{directives:[{name:"width",rawName:"v-width",value:100,expression:"100"}],staticClass:"text-ellipsis",attrs:{title:i.className},domProps:{textContent:t._s(i.className)}})]}}])}),a("TableItem",{attrs:{title:"定时规则",prop:"cron",align:"center",width:150}}),a("TableItem",{attrs:{title:"状态",align:"center",prop:"state",width:80}}),a("TableItem",{attrs:{title:"归属应用",prop:"appName",align:"center"}}),a("TableItem",{attrs:{title:"启用状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.data;return[a("h-switch",{attrs:{small:!0,trueValue:"1",falseValue:"0"},on:{change:function(e){return t.enabled(i)}},model:{value:i.enabled,callback:function(e){t.$set(i,"enabled",e)},expression:"data.enabled"}},[a("span",{attrs:{slot:"true"},slot:"true"},[t._v("启用")]),a("span",{attrs:{slot:"false"},slot:"false"},[t._v("停止")])])]}}])}),a("TableItem",{attrs:{title:"应用地址",prop:"appAddr",width:150,align:"center"}}),a("TableItem",{attrs:{title:"日志",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.data;return[a("Button",{attrs:{text:!0},on:{click:function(e){return t.openModal(i)}}},[t._v("日志")])]}}])}),a("TableItem",{attrs:{title:"操作",width:100,fixed:"right",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.data;return[a("DropdownMenu",{attrs:{datas:i.opts,trigger:"hover","class-name":"h-text-dropdown",width:100},on:{click:t.opt}},[a("span",[t._v("操作选择")])])]}}])}),a("div",{attrs:{slot:"empty"},slot:"empty"},[t._v("暂无数据")])],1),a("br"),t.pagination.total>0?a("Pagination",{attrs:{small:!1,align:"right",layout:"pager"},on:{change:t.changePage},model:{value:t.pagination,callback:function(e){t.pagination=e},expression:"pagination"}}):t._e(),a("br")],1)])},n=[],s=a("462f"),o=s["a"],l=a("2877"),r=Object(l["a"])(o,i,n,!1,null,"24c652e1",null);e["default"]=r.exports},"462f":function(t,e,a){"use strict";(function(t){a("ac6a");var i=a("f95b"),n=a("74d7"),s=a.n(n),o=a("4d20");e["a"]={name:"task-list",components:{TaskLogModal:o["a"]},data:function(){return{loading:!1,initData:[],pagination:{page:1,size:10,total:0},selected:"",appInfo:{},appInfos:[],open:0,appStatus:"",dicts:{openSimulation:[{itemCode:"1",itemText:"是"},{itemCode:"0",itemText:"否"}],reqMethod:[{itemCode:"GET",itemText:"GET"},{itemCode:"POST",itemText:"POST"},{itemCode:"PATCH",itemText:"PATCH"},{itemCode:"PUT",itemText:"PUT"},{itemCode:"DELETE",itemText:"DELETE"}],status:[{itemCode:"NORMAL",itemText:"正常"},{itemCode:"SUSPEND",itemText:"暂停"},{itemCode:"NONE",itemText:"停止"}],apiType:[{itemCode:"1000",itemText:"自动注册"},{itemCode:"2000",itemText:"手动注册"}],group:[{itemCode:"DEFAULT",itemText:"默认分组"}]},params:{}}},mounted:function(){this.init()},watch:{params:function(){this.getData()}},methods:{init:function(){this.getData()},getData:function(){var t=this;t.loading=!0;var e={};e.pagination=t.pagination,""!==this.selected&&(e.appName=this.selected),s.a.extend(e,this.params),i["a"].get("/simTaskManager/taskList",e).then(function(e){t.initData=e.data.list,t.initOpt(t.initData),t.pagination.total=e.data.total,t.loading=!1,console.log(e)})},initOpt:function(t){t.forEach(function(t){var e=t.state,a=t.id,i=t.enabled;t.opts=[{taskId:a,itemCode:"suspend",itemText:"暂停",disabled:"SUSPEND"===e||"NONE"===e||!i},{taskId:a,itemCode:"resume",itemText:"恢复",disabled:"NORMAL"===e||"NONE"===e||!i},{taskId:a,itemCode:"stop",itemText:"停止",disabled:"NONE"===e||!i},{taskId:a,itemCode:"start",itemText:"启动",disabled:"NORMAL"===e||"SUSPEND"===e||!i}]})},remove:function(e,a){t(this.appInfo),e.splice(e.indexOf(a),1)},add:function(t){},change:function(t){this.getData()},enabled:function(t){var e=this,a=this,n=t.id;this.$Loading();var s=t.enabled;0===s?s=1:1===s&&(s=0),i["a"].postJson("/simTaskManager/enabled?taskId="+n+"&enabled="+s).then(function(i){1===i.code?(t.enabled=s,a.$Message.success(i.data)):t.enabled=!s,a.$Loading.close(),e.getData()})},changePage:function(t){this.pagination=t,this.getData()},openModal:function(t){var e=this,a=this;this.$Modal({component:{vue:o["a"],datas:{taskInfo:t}},hasCloseIcon:!0,draggable:!0,events:{success:function(t,i){e.value=i,a.getData()}}})},opt:function(t,e){var a=this,n=this,s=e.taskId;i["a"].postJson("/simTaskManager/state?taskId="+s+"&state="+t).then(function(t){1===t.code?(e.openSimulation=open,n.$Message.success(t.data)):e.openSimulation=!open,n.$Loading.close(),a.getData()})}}}}).call(this,a("41fd"))},"4d20":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-log"},[a("header",{staticClass:"h-modal-header"},[t._v(t._s(t.taskInfo.taskName)+" - 执行日志")]),a("div",{staticStyle:{padding:"0"}},[a("div",{staticClass:"container"},[a("div",{staticClass:"shell-container"},[a("div",{staticClass:"body-shell"},[a("p",{staticClass:"INFO"}),t._l(t.initData.logList,function(e,i){return a("div",{class:e.level},[t.initData.splitLineNumArray[i]?a("div",{staticStyle:{"line-height":"50px"}},[a("span",{staticStyle:{color:"lightgrey"}},[t._v(t._s(t.taskInfo.taskName)+"，实例ID："+t._s(e.instanceId))])]):t._e(),a("div",[a("span",{domProps:{textContent:t._s(e.instanceId)}}),t._v(" \n              "),a("span",{domProps:{textContent:t._s(e.createDate)}}),t._v(" \n              "),a("span",{staticStyle:{width:"50px",display:"inline-block"},domProps:{textContent:t._s(e.level)}}),t._v(" \n              ["),a("span",{domProps:{textContent:t._s(t.taskInfo.className)}}),t._v("] :\n              "),a("span",{domProps:{textContent:t._s(e.log)}})])])})],2)])])])])},n=[],s=a("f95b"),o={name:"task-log-modal",props:{taskInfo:Object},data:function(){return{rules:{required:[]},initData:{logList:[],splitLineNumArray:[]},params:{reqMethod:null},dict:{reqMethod:[],reqMethods:["GET","POST","PATCH","PUT","DELETE"]}}},mounted:function(){this.init()},methods:{init:function(){var t=this,e=this.taskInfo.id,a={taskId:e};s["a"].get("/simTaskManager/logList",a).then(function(e){var a=e.data.list;t.initData.logList=a;var i=-1;for(var n in a){var s=a[n];s.instanceId!=i&&(t.initData.splitLineNumArray[n]=!0,i=s.instanceId)}console.log(t.initData.splitLineNumArray)})},success:function(){var t=this,e=this.$refs.form.valid();if(e.result){var a=this,i={};i.apiUrl=this.apiInfo.apiUrl,i.appName=this.apiInfo.appName,i.reqMethod=this.apiInfo.reqMethod,i.resData=this.params.resData,s["a"].postJson("/api/update-api",i).then(function(e){1===e.code&&(t.$emit("success",!0),a.$Message.success("修改成功"))})}},close:function(){this.$emit("close")},del:function(){var t=this,e=this,a={};a.apiUrl=this.apiInfo.apiUrl,a.appName=this.apiInfo.appName,a.reqMethod=this.apiInfo.reqMethod,s["a"].postJson("/api/delete-api",a).then(function(a){1===a.code&&(t.$emit("success",!0),t.close(),e.$Message.success("删除成功"))})}}},l=o,r=(a("7922"),a("2877")),c=Object(r["a"])(l,i,n,!1,null,"35ea67b5",null);e["a"]=c.exports},7922:function(t,e,a){"use strict";var i=a("e482"),n=a.n(i);n.a},e482:function(t,e,a){}}]);
//# sourceMappingURL=chunk-11a7ce03.b2719734.js.map